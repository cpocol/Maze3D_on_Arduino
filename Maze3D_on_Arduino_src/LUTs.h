const int16_t screenW_lowResFactor = 1;

const int32_t PROGMEM Tan_fp[] = {
         0,        536,       1072,       1608,       2145,       2682,       3219,       3757,       4295,       4834,       5373,       5913,       6454,       6996,       7539,       8082, 
      8627,       9173,       9721,      10269,      10819,      11371,      11924,      12479,      13035,      13593,      14153,      14716,      15280,      15846,      16415,      16986, 
     17559,      18135,      18714,      19295,      19879,      20466,      21056,      21649,      22245,      22845,      23448,      24054,      24665,      25279,      25897,      26518, 
     27145,      27775,      28409,      29049,      29692,      30341,      30995,      31653,      32317,      32986,      33661,      34342,      35028,      35720,      36419,      37124, 
     37835,      38554,      39279,      40011,      40751,      41498,      42253,      43016,      43788,      44567,      45356,      46153,      46960,      47776,      48602,      49439, 
     50285,      51142,      52010,      52890,      53781,      54685,      55600,      56529,      57471,      58426,      59395,      60379,      61378,      62392,      63422,      64469, 
     65532,      66614,      67713,      68831,      69968,      71126,      72304,      73503,      74725,      75970,      77239,      78532,      79851,      81197,      82570,      83971, 
     85403,      86865,      88359,      89887,      91449,      93048,      94684,      96359,      98075,      99833,     101636,     103485,     105383,     107331,     109332,     111389, 
    113503,     115678,     117917,     120223,     122599,     125049,     127577,     130187,     132882,     135669,     138552,     141536,     144628,     147833,     151159,     154612, 
    158202,     161936,     165825,     169877,     174106,     178522,     183139,     187973,     193039,     198355,     203941,     209819,     216013,     222551,     229462,     236781, 
    244545,     252799,     261591,     270976,     281018,     291790,     303377,     315876,     329401,     344087,     360090,     377600,     396843,     418091,     441680,     468021, 
    497631,     531165,     569460,     613618,     665102,     725909,     798834,     887915,     999206,    1142217,    1332794,    1599444,    1999147,    2664691,    3993722,    7965491, 
   8388607,   -8056226,   -4016407,   -2674775,   -2004820,   -1603075,   -1335316,   -1144071,   -1000625,    -889037,    -799743,    -726660,    -665734,    -614157,    -569925,    -531570, 
   -497988,    -468337,    -441962,    -418345,    -397072,    -377808,    -360280,    -344260,    -329561,    -316023,    -303513,    -291917,    -281136,    -271086,    -261693,    -252895, 
   -244636,    -236866,    -229543,    -222627,    -216086,    -209888,    -204006,    -198417,    -193098,    -188029,    -183193,    -178573,    -174155,    -169924,    -165869,    -161979, 
   -158243,    -154652,    -151197,    -147870,    -144663,    -141570,    -138585,    -135701,    -132913,    -130217,    -127606,    -125078,    -122627,    -120250,    -117943,    -115703, 
   -113527,    -111412,    -109355,    -107353,    -105405,    -103507,    -101657,     -99854,     -98095,     -96378,     -94703,     -93066,     -91467,     -89905,     -88377,     -86882, 
    -85419,     -83988,     -82585,     -81212,     -79866,     -78547,     -77253,     -75984,     -74739,     -73517,     -72317,     -71139,     -69981,     -68844,     -67725,     -66626, 
    -65545,     -64481,     -63434,     -62404,     -61389,     -60390,     -59406,     -58437,     -57481,     -56539,     -55611,     -54695,     -53791,     -52900,     -52020,     -51152, 
    -50295,     -49448,     -48612,     -47786,     -46969,     -46162,     -45365,     -44576,     -43796,     -43025,     -42262,     -41507,     -40759,     -40020,     -39287,     -38562, 
    -37843,     -37132,     -36427,     -35728,     -35036,     -34349,     -33669,     -32994,     -32325,     -31661,     -31002,     -30348,     -29700,     -29056,     -28417,     -27782, 
    -27152,     -26526,     -25904,     -25286,     -24672,     -24061,     -23455,     -22852,     -22252,     -21656,     -21063,     -20473,     -19886,     -19302,     -18720,     -18142, 
    -17566,     -16992,     -16421,     -15853,     -15286,     -14722,     -14160,     -13600,     -13041,     -12485,     -11930,     -11377,     -10825,     -10275,      -9727,      -9179, 
     -8633,      -8089,      -7545,      -7002,      -6460,      -5919,      -5379,      -4840,      -4301,      -3763,      -3225,      -2688,      -2151,      -1614,      -1078,       -542, 
        -6,        530,       1066,       1602,       2139,       2676,       3213,       3751,       4289,       4827,       5367,       5907,       6448,       6990,       7532,       8076, 
      8621,       9167,       9714,      10263,      10813,      11364,      11918,      12472,      13029,      13587,      14147,      14709,      15273,      15840,      16408,      16979, 
     17553,      18129,      18707,      19288,      19872,      20459,      21049,      21642,      22238,      22838,      23441,      24048,      24658,      25272,      25890,      26511, 
     27137,      27768,      28402,      29041,      29685,      30334,      30987,      31646,      32310,      32979,      33654,      34334,      35020,      35712,      36411,      37116, 
     37827,      38545,      39271,      40003,      40742,      41490,      42245,      43008,      43779,      44559,      45347,      46144,      46951,      47767,      48593,      49429, 
     50275,      51132,      52001,      52880,      53771,      54674,      55590,      56518,      57460,      58415,      59384,      60368,      61367,      62381,      63411,      64457, 
     65520,      66601,      67700,      68818,      69955,      71112,      72290,      73490,      74711,      75956,      77224,      78517,      79836,      81181,      82554,      83955, 
     85387,      86848,      88342,      89870,      91432,      93030,      94665,      96340,      98055,      99813,     101616,     103464,     105361,     107309,     109309,     111365, 
    113479,     115653,     117892,     120197,     122572,     125021,     127548,     130157,     132851,     135637,     138519,     141502,     144592,     147796,     151120,     154572, 
    158160,     161893,     165780,     169830,     174057,     178471,     183086,     187917,     192980,     198294,     203877,     209751,     215941,     222475,     229382,     236696, 
    244455,     252702,     261488,     270866,     280900,     291664,     303241,     315729,     329242,     343914,     359901,     377393,     396614,     417838,     441397,     467705, 
    497276,     530760,     568997,     613079,     664470,     725158,     797928,     886793,     997788,    1140369,    1330284,    1595838,    1993492,    2654671,    3971292,    7876890, 
   8388607,   -8149172,   -4039350,   -2684921,   -2010510,   -1606732,   -1337851,   -1145930,   -1002047,    -890159,    -800656,    -727414,    -666366,    -614696,    -570392,    -531976, 
   -498345,    -468653,    -442243,    -418598,    -397301,    -378016,    -360469,    -344434,    -329721,    -316171,    -303650,    -292043,    -281254,    -271196,    -261796,    -252992, 
   -244727,    -236952,    -229623,    -222703,    -216157,    -209956,    -204071,    -198479,    -193157,    -188085,    -183247,    -178624,    -174203,    -169971,    -165915,    -162022, 
   -158285,    -154692,    -151235,    -147907,    -144699,    -141605,    -138618,    -135733,    -132944,    -130247,    -127635,    -125106,    -122654,    -120276,    -117969,    -115728, 
   -113552,    -111436,    -109378,    -107376,    -105427,    -103528,    -101678,     -99874,     -98114,     -96397,     -94721,     -93085,     -91485,     -89922,     -88394,     -86899, 
    -85436,     -84004,     -82601,     -81227,     -79881,     -78562,     -77268,     -75999,     -74753,     -73531,     -72331,     -71152,     -69994,     -68856,     -67738,     -66638, 
    -65557,     -64493,     -63446,     -62415,     -61401,     -60402,     -59417,     -58448,     -57492,     -56550,     -55621,     -54705,     -53802,     -52910,     -52030,     -51162, 
    -50304,     -49458,     -48621,     -47795,     -46978,     -46172,     -45374,     -44585,     -43805,     -43034,     -42270,     -41515,     -40768,     -40028,     -39295,     -38570, 
    -37852,     -37140,     -36435,     -35736,     -35044,     -34357,     -33677,     -33002,     -32332,     -31668,     -31010,     -30356,     -29707,     -29063,     -28424,     -27789, 
    -27159,     -26533,     -25911,     -25293,     -24679,     -24068,     -23462,     -22858,     -22259,     -21662,     -21069,     -20479,     -19892,     -19308,     -18727,     -18148, 
    -17572,     -16999,     -16428,     -15859,     -15293,     -14728,     -14166,     -13606,     -13048,     -12491,     -11936,     -11383,     -10832,     -10282,      -9733,      -9186, 
     -8640,      -8095,      -7551,      -7008,      -6466,      -5925,      -5385,      -4846,      -4307,      -3769,      -3231,      -2694,      -2157,      -1620,      -1084,       -548, };

const int32_t PROGMEM CTan_fp[] = {
   8388607,    8010588,    4005025,    2669719,    2001976,    1601259,    1334055,    1143144,     999915,     888476,     799288,     726284,     665417,     613887,     569693,     531367, 
    497810,     468179,     441821,     418218,     396957,     377704,     360185,     344174,     329481,     315950,     303445,     291853,     281077,     271031,     261642,     252847, 
    244591,     236824,     229502,     222589,     216050,     209853,     203974,     198386,     193068,     188001,     183166,     178547,     174130,     169901,     165847,     161958, 
    158223,     154632,     151178,     147851,     144645,     141553,     138568,     135685,     132898,     130202,     127592,     125063,     122613,     120236,     117930,     115691, 
    113515,     111400,     109344,     107342,     105394,     103496,     101647,      99843,      98085,      96369,      94693,      93057,      91458,      89896,      88368,      86874, 
     85411,      83980,      82578,      81204,      79859,      78540,      77246,      75977,      74732,      73510,      72310,      71132,      69975,      68837,      67719,      66620, 
     65539,      64475,      63428,      62398,      61384,      60385,      59401,      58431,      57476,      56534,      55606,      54690,      53786,      52895,      52015,      51147, 
     50290,      49443,      48607,      47781,      46965,      46158,      45360,      44572,      43792,      43021,      42258,      41502,      40755,      40015,      39283,      38558, 
     37839,      37128,      36423,      35724,      35032,      34346,      33665,      32990,      32321,      31657,      30998,      30345,      29696,      29052,      28413,      27778, 
     27148,      26522,      25900,      25282,      24668,      24058,      23451,      22848,      22249,      21652,      21059,      20469,      19882,      19298,      18717,      18138, 
     17563,      16989,      16418,      15849,      15283,      14719,      14157,      13596,      13038,      12482,      11927,      11374,      10822,      10272,       9724,       9176, 
      8630,       8085,       7542,       6999,       6457,       5916,       5376,       4837,       4298,       3760,       3222,       2685,       2148,       1611,       1075,        539, 
         3,       -533,      -1069,      -1605,      -2142,      -2679,      -3216,      -3754,      -4292,      -4831,      -5370,      -5910,      -6451,      -6993,      -7536,      -8079, 
     -8624,      -9170,      -9717,     -10266,     -10816,     -11368,     -11921,     -12475,     -13032,     -13590,     -14150,     -14712,     -15277,     -15843,     -16412,     -16983, 
    -17556,     -18132,     -18710,     -19292,     -19876,     -20463,     -21053,     -21646,     -22242,     -22841,     -23444,     -24051,     -24661,     -25275,     -25893,     -26515, 
    -27141,     -27771,     -28406,     -29045,     -29689,     -30337,     -30991,     -31650,     -32313,     -32983,     -33657,     -34338,     -35024,     -35716,     -36415,     -37120, 
    -37831,     -38550,     -39275,     -40007,     -40747,     -41494,     -42249,     -43012,     -43783,     -44563,     -45351,     -46149,     -46956,     -47772,     -48598,     -49434, 
    -50280,     -51137,     -52006,     -52885,     -53776,     -54679,     -55595,     -56524,     -57465,     -58420,     -59390,     -60374,     -61372,     -62386,     -63416,     -64463, 
    -65526,     -66607,     -67707,     -68824,     -69962,     -71119,     -72297,     -73497,     -74718,     -75963,     -77231,     -78525,     -79844,     -81189,     -82562,     -83963, 
    -85395,     -86857,     -88351,     -89878,     -91441,     -93039,     -94675,     -96349,     -98065,     -99823,    -101626,    -103475,    -105372,    -107320,    -109321,    -111377, 
   -113491,    -115666,    -117904,    -120210,    -122586,    -125035,    -127563,    -130172,    -132867,    -135653,    -138535,    -141519,    -144610,    -147814,    -151139,    -154592, 
   -158181,    -161915,    -165802,    -169854,    -174081,    -178496,    -183113,    -187945,    -193010,    -198324,    -203909,    -209785,    -215977,    -222513,    -229422,    -236738, 
   -244500,    -252751,    -261539,    -270921,    -280959,    -291727,    -303309,    -315803,    -329322,    -344000,    -359996,    -377496,    -396728,    -417964,    -441539,    -467864, 
   -497453,    -530963,    -569228,    -613349,    -664785,    -725533,    -798379,    -887355,    -998499,   -1141292,   -1331540,   -1597634,   -1996323,   -2659665,   -3982476,   -7920771, 
  -8388607,    8102253,    4027846,    2679832,    2007668,    1604897,    1336584,    1145000,    1001339,     889599,     800198,     727037,     666050,     614427,     570158,     531773, 
    498166,     468496,     442103,     418471,     397186,     377912,     360375,     344347,     329641,     316097,     303582,     291980,     281194,     271141,     261745,     252944, 
    244681,     236909,     229583,     222665,     216122,     209922,     204039,     198448,     193127,     188057,     183220,     178599,     174179,     169948,     165892,     162001, 
    158264,     154672,     151216,     147888,     144681,     141588,     138602,     135717,     132929,     130232,     127621,     125092,     122640,     120263,     117956,     115716, 
    113540,     111424,     109367,     107365,     105416,     103517,     101667,      99864,      98104,      96388,      94712,      93075,      91476,      89913,      88385,      86890, 
     85427,      83996,      82593,      81220,      79874,      78554,      77260,      75991,      74746,      73524,      72324,      71145,      69988,      68850,      67732,      66632, 
     65551,      64487,      63440,      62410,      61395,      60396,      59412,      58442,      57487,      56545,      55616,      54700,      53797,      52905,      52025,      51157, 
     50300,      49453,      48617,      47790,      46974,      46167,      45369,      44581,      43801,      43029,      42266,      41511,      40764,      40024,      39291,      38566, 
     37848,      37136,      36431,      35732,      35040,      34353,      33673,      32998,      32328,      31665,      31006,      30352,      29703,      29060,      28420,      27786, 
     27155,      26529,      25907,      25289,      24675,      24065,      23458,      22855,      22255,      21659,      21066,      20476,      19889,      19305,      18724,      18145, 
     17569,      16996,      16425,      15856,      15289,      14725,      14163,      13603,      13044,      12488,      11933,      11380,      10829,      10279,       9730,       9183, 
      8636,       8092,       7548,       7005,       6463,       5922,       5382,       4843,       4304,       3766,       3228,       2691,       2154,       1617,       1081,        545, 
         9,       -527,      -1063,      -1599,      -2136,      -2673,      -3210,      -3748,      -4286,      -4824,      -5364,      -5904,      -6445,      -6987,      -7529,      -8073, 
     -8618,      -9164,      -9711,     -10260,     -10810,     -11361,     -11914,     -12469,     -13026,     -13584,     -14144,     -14706,     -15270,     -15837,     -16405,     -16976, 
    -17550,     -18125,     -18704,     -19285,     -19869,     -20456,     -21046,     -21639,     -22235,     -22835,     -23438,     -24044,     -24654,     -25268,     -25886,     -26508, 
    -27134,     -27764,     -28399,     -29038,     -29682,     -30330,     -30984,     -31642,     -32306,     -32975,     -33650,     -34330,     -35016,     -35709,     -36407,     -37112, 
    -37823,     -38541,     -39266,     -39999,     -40738,     -41485,     -42240,     -43003,     -43774,     -44554,     -45342,     -46140,     -46946,     -47762,     -48588,     -49424, 
    -50271,     -51128,     -51996,     -52875,     -53766,     -54669,     -55585,     -56513,     -57454,     -58410,     -59379,     -60362,     -61361,     -62375,     -63405,     -64451, 
    -65514,     -66595,     -67694,     -68812,     -69949,     -71106,     -72284,     -73483,     -74704,     -75949,     -77217,     -78510,     -79829,     -81174,     -82546,     -83947, 
    -85378,     -86840,     -88334,     -89861,     -91423,     -93020,     -94656,     -96330,     -98045,     -99803,    -101605,    -103454,    -105350,    -107298,    -109298,    -111353, 
   -113467,    -115641,    -117879,    -120184,    -122558,    -125007,    -127533,    -130142,    -132836,    -135621,    -138502,    -141484,    -144574,    -147777,    -151101,    -154552, 
   -158140,    -161871,    -165757,    -169807,    -174032,    -178445,    -183059,    -187889,    -192951,    -198263,    -203844,    -209717,    -215905,    -222437,    -229342,    -236653, 
   -244410,    -252655,    -261437,    -270811,    -280841,    -291601,    -303173,    -315656,    -329162,    -343827,    -359807,    -377289,    -396499,    -417711,    -441257,    -467548, 
   -497099,    -530557,    -568764,    -612812,    -664157,    -724782,    -797473,    -886237,    -997086,   -1139452,   -1329025,   -1594028,   -1990698,   -2649721,   -3960114,   -7833045, };
